{% extends "../base.html" %}
{% load i18n %}
{% load humanize %}

{% block title %}{{ repo.name }}{% endblock %}


{% block content %}

<h1 style="vertical-align: middle;"><img src="{{ repo.icon.url }}"/> {{ repo.name }}</h1>
<p>{{ repo.description }}</p>

{% if repo.last_publication_date %}
<div class="mdc-card mdc-ripple-surface" style="float: right;">
	<a href="{{ repo.get_fingerprint_url }}">
		<img src="{{ repo.qrcode.url }}"/>
	</a>
</div>
{% endif %}

<ul class="mdc-list mdc-list--dense">
    <li class="mdc-list-item">
	    <i class="mdc-list-item__start-detail material-icons">insert_link</i>
		<!-- TODO: Figure out the best way to translate this -->
	    URL: <a href="{{ repo.get_fingerprint_url }}">{{ repo.url }}</a>
    </li>
    <li class="mdc-list-item">
	    <i class="mdc-list-item__start-detail material-icons">fingerprint</i>
		{% blocktrans with fingerprint=repo.fingerprint %}Fingerprint: {{ fingerprint }}{% endblocktrans %}
    </li>
    <li class="mdc-list-item">
	    <i class="mdc-list-item__start-detail material-icons">watch_later</i>
		{% blocktrans with date_1=repo.created_date|naturaltime date_2=repo.created_date|date:"SHORT_DATE_FORMAT" %} Created: {{ date_1 }} ({{ date_2 }}){% endblocktrans %}
    </li>
    <li class="mdc-list-item">
	    <i class="mdc-list-item__start-detail material-icons">update</i>
		{% blocktrans with date_1=repo.last_updated_date|naturaltime date_2=repo.last_updated_date|date:"SHORT_DATE_FORMAT" %} Last Updated: {{ date_1 }} ({{ date_2 }}){% endblocktrans %}
	</li>
	<li class="mdc-list-item">
		<i class="mdc-list-item__start-detail material-icons">schedule</i>
		{% blocktrans with date_1=repo.last_publication_date|naturaltime date_2=repo.last_publication_date|date:"SHORT_DATE_FORMAT"|default:"Never" %} Last Publication: {{ date_1 }} ({{ date_2 }}){% endblocktrans %}
	</li>
</ul>

<h2 style="float: clear;">Storage</h2>
{% if ssh_storage or s3_storage %}
<ul class="mdc-list">
    {% for storage in ssh_storage %}
    <li class="mdc-list-item">
	    <i class="mdc-list-item__start-detail material-icons">cloud</i>
        {{ storage }}
        <a href="{% url 'storage_ssh_update' repo.id storage.id %}" class="material-icons mdc-ripple-surface" style="padding: 0.5em;">edit</a>
        <a href="{% url 'storage_ssh_delete' repo.id storage.id %}" class="material-icons mdc-ripple-surface" style="padding: 0.5em;">delete</a>
    </li>
    {% endfor %}
    {% for storage in s3_storage %}
    <li class="mdc-list-item">
	    <i class="mdc-list-item__start-detail material-icons">cloud</i>
        {{ storage }}
        <a href="{% url 'storage_s3_update' repo.id storage.id %}" class="material-icons mdc-ripple-surface" style="padding: 0.5em;">edit</a>
        <a href="{% url 'storage_s3_delete' repo.id storage.id %}" class="material-icons mdc-ripple-surface" style="padding: 0.5em;">delete</a>
    </li>
    {% endfor %}
</ul>
{% else %}
<p><b>{% trans 'Attention:' %}</b> {% trans 'This repository has no remote storage. Add one to get your repository published.' %}</p>
{% endif %}

<p>
	<a href="{% url 'storage_ssh_add' repo.id %}" class="rm-no-underline" style="margin-right:1em;">
		<button class="mdc-button mdc-button--raised">{% trans 'Add SSH Storage' %}</button>
	</a>
	<a href="{% url 'storage_s3_add' repo.id %}" class="rm-no-underline">
		<button class="mdc-button mdc-button--raised">{% trans 'Add Amazon S3 Storage' %}</button>
	</a>
</p>

<h2>{% trans 'Apps' %}</h2>

<ul class="mdc-list mdc-list--two-line">
	{% for app in apps %}
	<li class="mdc-list-item">
		<a href="{% url 'app' repo.id app.id %}" class="mdc-ripple-surface">
			<img src="{{ app.icon.url }}" style="float: left; margin-right: 1em;"/>
			<span class="mdc-list-item__text" style="margin-right: 1em;">
                <span class="mdc-list-item__text__primary">{{ app.name }}</span>
                <span class="mdc-list-item__text__secondary">{{ app.summary }}</span>
			</span>
			<a href="{% url 'edit_app' repo.id app.id %}" class="material-icons mdc-ripple-surface" style="padding: 0.5em;">edit</a>
			<a href="{% url 'delete_app' repo.id app.id %}" class="material-icons mdc-ripple-surface" style="padding: 0.5em;">delete</a>
		</a>
	</li>
	{% empty %}
	<li class="mdc-list-item">{% trans 'No apps in this repository.' %}</li>
	{% endfor %}
</ul>

<p></p>

<a href="{% url 'add_app' repo.id %}" class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12 rm-no-underline">
	<button class="mdc-fab material-icons">
		<span class="mdc-fab__icon">add</span>
	</button>
</a>

{% endblock content %}
